<loading isLoading="{{ isLoading }}" />

<view class="container" wx:if="{{!isLoading}}">
	<!-- 会员用户 -->
	<view class="member-header {{ config.store_card_enable ? '' : 'noMemberCard' }}" style="background-color: {{ themeColor.primaryColor }}" wx:if="{{ user.membership.is_member }}">
		<view class="member-top {{ config.store_card_enable ? '' : 'noCard' }}">
			<button class="head-button" style="background-color: {{ themeColor.primaryColor }}" bindgetuserinfo="bindGetUserInfo" open-type="getUserInfo" bindtap="consoleOpen">
				<image src="{{ user.avatarurl ? user.avatarurl : '/icons/unlogin.png' }}" mode="aspectFit" class="avatar"></image>
				<view class="member-text">
					<view class="member-user">{{ !user.nickname ? '点击头像登录' : user.nickname }}</view>
					<view class="member-level">{{ membershipCard.user.level_name }}</view>
				</view>
			</button>
			<navigator url="/pages/membership/integralList/integralList" class="integral-text" wx:if="{{ !config.store_card_enable }}">
				<view class="cart-price">{{ membershipCard.user.exp }}</view>
				<view class="cart-text">积分</view>
			</navigator>
			<button class="member-concat" data-name="contact" open-type="contact" session-from='{"nickName":"{{ user.nickname }}", "avatarUrl":"{{ user.avatarurl }}", "from":"me"}' style="background-color: {{ themeColor.primaryColor }}">
				<image class="member-itemIcon" mode="aspectFit" src="/icons/memberConcat.svg" />
				<view class="member-itemTitle">联系客服</view>
			</button>
		</view>
		<view class="member-bottom" wx:if="{{ config.store_card_enable }}">
			<navigator url="/pages/membership/consumptionCenter/consumptionCenter" class="member-integral-text">
				<view class="cart-price">{{ membershipCard.user.cash_balance }} 元</view>
				<view class="cart-text">储值余额</view>
			</navigator>
			<navigator url="/pages/membership/consumptionCenter/consumptionCenter" class="member-integral-text">
				<view class="cart-price">{{ membershipCard.user.gift_balance }} 元</view>
				<view class="cart-text">赠送余额</view>
			</navigator>
			<navigator url="/pages/membership/integralList/integralList" class="member-integral-text">
				<view class="cart-price">{{ membershipCard.user.exp }}</view>
				<view class="cart-text">积分</view>
			</navigator>
		</view>
	</view>

	<!-- 普通用户 -->
	<view class="header" style="background-color: {{ themeColor.primaryColor }}" wx:if="{{ !user.membership.is_member }}">
		<view class="member-top">
			<button class="head-button" style="background-color: {{ globalData.themeColor.primaryColor  }}" bindgetuserinfo="bindGetUserInfo" open-type="getUserInfo" bindtap="consoleOpen">
				<image src="{{ user.avatarurl ? user.avatarurl : '/icons/unlogin.png' }}" mode="aspectFit" class="avatar"></image>
				<view class="member-text">
					<text class="member-user">{{ !user.nickname ? '点击头像登录' : user.nickname }}</text>
					<view class="member-level">普通用户</view>
				</view>
			</button>
			<button class="member-concat" data-name="contact" open-type="contact" session-from='{"nickName":"{{ user.nickname }}", "avatarUrl":"{{ user.avatarurl }}", "from":"me"}' style="background-color: {{ themeColor.primaryColor }}">
				<image class="member-itemIcon" mode="aspectFit" src="/icons/memberConcat.svg" />
				<view class="member-itemTitle">联系客服</view>
			</button>
		</view>
		<!-- 已开通储值卡功能 -->
		<view class="member-bottom" wx:if="{{ config.store_card_enable }}">
			<view class="member-price">{{ membershipCard.word }}</view>
			<view class="member-btn" bindtap="openRechargeModal">立即开通会员</view>
		</view>
		<!-- 没开储值卡功能 -->
		<view class="member-bottom" wx:if="{{ !config.store_card_enable }}">
			<view class="member-price">开通会员仅需{{ globalData.CURRENCY[globalData.currency] }}{{ config.membership.rules.payment }}</view>
			<view class="member-btn" bindtap="buyMember">立即开通会员</view>
		</view>
	</view>

	<!-- 会员充值弹窗 -->
	<popup rechargeModal="{{ rechargeModal }}" rechargeArray="{{ rechargeArray }}" user="{{ user }}" config="{{ config }}"></popup>

	<image class="rule-image" src="{{ image_url }}" mode="widthFix"/>
</view>

<console page="会员中心" />