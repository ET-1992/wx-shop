<van-popup round show="{{ isShowSkuModal }}" style="--popup-round-border-radius: 20rpx" position="{{ position }}" bind:close="close" duration="{{ duration }}" z-index="{{10000}}">
  <!-- classify 页面 -->
  <!-- <view wx:if="{{ position === 'center' }}" class="modal">
        <view class="header">
            <view class="headerText">{{ product.title }}</view>
            <van-icon name="clear" custom-class="close" color="#dcdde0" size="20px" bind:click="close" />
        </view>
        <view class="content">
            <skuOptionList product="{{ product }}" bind:select="onOptionSelect" />
            <skuLogistics product="{{product}}" actions="{{actions}}" bind:shipping-change="getShippingType" />
        </view>
        <view class="footer">
            <view class="money" wx:if="{{ product.groupon_enable && isGrouponBuy }}">
                {{ globalData.CURRENCY[globalData.currency] }}{{ product.definePrice }}
            </view>
            <view class="money" wx:elif="{{ !(now > product.miaosha_end_timestamp) && (now > product.miaosha_start_timestamp) && product.miaosha_enable }}">
                {{ globalData.CURRENCY[globalData.currency] }}{{ product.miaosha_price }}
            </view>
            <view class="money" wx:else>
                {{ globalData.CURRENCY[globalData.currency] }}{{ selectedSku.id ? selectedSku.price : product.price }}
            </view>
            <button class="addCart" bind:tap="onAddCart" data-id="{{ product.id }}" style="background:{{ themeColor.primaryColor }}">
                加入购物车
            </button>
        </view>
    </view> -->
  <!-- 商品详情页面 -->
  <view wx:if="{{ position === 'bottom' }}" class="bottomModal" z-index="{{10000}}">
    <!-- 顶部title -->
    <view class="head-title">{{  actions[0].type=='onBuy' ? '立即购买': '加入购物车'}}</view>
    <view class="modal-line"></view>
    <!-- <view class="head-address">
            <view class="address-left">
                <van-icon name="location-o" size="48rpx" color="#B0B3BF"/>
                <text class="{{product.shippingaddress?'shipping-address':'address-text'}}">{{product.shippingaddress?product.shippingaddress :'添加地址'}}</text>
            </view>
            <van-icon name="arrow" size='32rpx' color="#B0B3BF"/>
        </view> -->
    <address wx:if="{{showAddress}}" id="address"></address>
    <view class="head-wrap">
      <!-- <view class="head-close">
                <van-icon name="clear" color="#dcdde0" size="20px" bind:click="close" />
            </view> -->
      <view class="head">
        <image src="{{ product.sku_images[currentSku[0].value].thumbnail || product.thumbnail || product.images[0] }}" data-src="{{ product.sku_images[currentSku[0].value].thumbnail || product.thumbnail || product.images[0] }}" class="productImage" mode="aspectFill" catchtap="previewImage" />
        <view class="productInfo">
          <!-- 金币商品 -->
          <!-- <view class="coin-product-price" wx:if="{{ product.product_type === 4 }}">
                        <view class="coin-num">
                            <text>{{ selectedSku.coin_fee || product.coin_fee }}</text>
                            <text class="currency">{{ config.coin_name || '花生米' }}</text>
                        </view>
                        <view class="price-join-symbol">+</view>
                        <view class="price-num">
                            <text>{{ globalData.CURRENCY[globalData.currency] }}</text>
                            <text>{{ selectedSku.coin_price || product.coin_price }}</text>
                        </view>
                    </view> -->
          <view class="price">
            <view style="display: flex">
              <view wx:if="{{ product.coupons_price }}">券后</view>
              <view class="currency">{{ globalData.CURRENCY[globalData.currency] }}</view>
              <view class="groupon">
                <text>{{ selectedOptions.price - product.coupons_price }}</text>
              </view>
            </view>
            <view>
              <!-- <text>{{ product.definePrice + selectedOptions.relationPrice }}</text> -->
              <view class="price-last" wx:if="{{ product.coupons_price }}">
                券前¥
                <text class="">{{ selectedOptions.price }}</text>
              </view>
            </view>
          </view>
          <view>
            <!-- <view class="blur_stock" wx:if="{{ product.blur_stock }}" style="background-color: {{ selectedOptions.stockColor ? selectedOptions.stockColor : product.stockColor }}">
                        {{ selectedOptions.stockText ? selectedOptions.stockText : product.stockText }}
                    </view>
                    <view class="stock" wx:else>
                        剩余：{{ !selectedSku.stock && selectedSku.stock !== 0 ? product.stock : selectedSku.stock }}
                    </view>
                   </view> -->
            <view class="property" wx:if="{{ product.skus.length || product.special_attributes.length || product.related_product.length }}">
              已选择：{{ selectedOptions.content || '--' }}
            </view>
            <!-- 步进器 -->
            <view class="stepper">
              <!-- <van-stepper input-class="stepper-input" plus-class="stepper-plus" minus-class="{{ product.shopNum===1?'stepper-minus':'stepper-plus'}}" value="{{ product.shopNum}}" bind:change="" /> -->
              <numberInput value="{{ quantity }}" postId="{{ product.id }}" skuId="{{ selectedSku.id }}" max="{{ !selectedSku.stock && selectedSku.stock !== 0 ? product.stock : selectedSku.stock }}" bindquantityChangeEvent="updateQuantity" quota="{{ product.quota }}" least="{{ product.least }}" />
            </view>
          </view>
        </view>
      </view>
      <scroll-view scroll-y="{{ scrollEnable }}" class="scroll-content-wrap">
        <!-- 商家优惠劵 -->
        <view class="merchant-Coupons" wx:if="{{ product.coupons_price }}">
          <view class="Coupons-left">优惠</view>
          <view class="Coupons-right">
            商家券
            <text class="Coupons-num">-{{product.coupons_price || 0}}元</text>
            <!-- <van-icon name="arrow" size='32rpx' color="#B0B3BF" /> -->
          </view>
        </view>
        <view class="scroll-content">
          <skuOptionList product="{{ product }}" bind:select="onOptionSelect" />
          <!-- <view class="product-remark" wx:if="{{ product.product_annotation.length }}">
                    <view class="remark-title">留言</view>
                    <markForm id="mark-form" formFields="{{ product.product_annotation }}" showSubmitBtn="{{false}}" bind:change-form-focus="onChangeFormFocus"></markForm>
                </view> -->
          <view wx:if="{{actions[0].type=='onBuy'}}">
            <view class="pay" bindtap="goCouponList">
              <text>优惠券</text>
              <text wx:if="{{coupon.length>0}}" class="pay-right">
                {{coupon.length>0?coupon[0].title:''}}
              </text>
              <van-icon wx:else name="arrow" size='32rpx' color="#B0B3BF" />
            </view>
            <view class="modal-line" />
            <view class="pay">
              <text>支付方式</text>
              <text class="pay-right">微信支付</text>
            </view>
            <view class="modal-line" />
            <view class="pay">
              <text>运费</text>
              <text class="pay-right">免费</text>
            </view>
            <view class="modal-line" />
            <!-- <van-cell-group>
            <van-field value="免费" label="运费" input-align="right" disabled border="{{ false }}" />
          </van-cell-group> -->
            <van-cell-group>
              <van-field value="{{ message }}" label="留言" type="textarea" bind:change="onChangeMessage" placeholder="请输入留言" autosize border="{{ false }}" label-class="message-label" />
            </van-cell-group>
          </view>
        </view>
      </scroll-view>
      <!-- <view class="bottom-option-wrap">
            <view class="quantity" wx:if="{{ product.product_type !== 1 && !isBargainBuy}}">
                <view class="title">购买数量</view>
                <view class="rightWrap">
                    <view class="least" wx:if="{{ product.least }}">（ {{ product.least }}件起购 ）</view>
                     <numberInput value="{{ quantity }}" postId="{{ product.id }}" skuId="{{ selectedSku.id }}" max="{{ !selectedSku.stock && selectedSku.stock !== 0 ? product.stock : selectedSku.stock }}" bindquantityChangeEvent="updateQuantity" quota="{{ product.quota }}" least="{{ product.least }}" />
                </view>
            </view>
            <skuLogistics product="{{product}}" actions="{{actions}}" bind:shipping-change="getShippingType" />
        </view> -->
      <view class="actionSheetBtGroup">
        <button class="confirmBt {{ index + 1 === actions.length ? '' : 'secondaryBt' }}" wx:for="{{ actions }}" wx:key="id" data-action-type="{{ item.type }}" form-type="submit" bindtap="onUserInfo" lang="zh_CN" style="{{isCrowd ? ('background-image:url(' + config.cdn_host + '/shop/addCrowdBg.png);') : 'background-color:'}}{{ index + 1 === actions.length ? themeColor.primaryColor : themeColor.secondaryColor }}">
          {{ item.text }}
        </button>
      </view>
    </view>
  </view>
</van-popup>