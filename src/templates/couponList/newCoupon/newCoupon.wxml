<view class="coupon newCoupon">
  <view class="couponItem">
    <view class="couponInfo">
      <view class="left">
        <view class="reduce">
          <text class="yuan" wx:if="{{ coupon.type == 1 }}">
            {{ globalData.CURRENCY[globalData.currency] }}
          </text>
          <text class="reduceCost" wx:if="{{coupon.type == 2}}">{{ coupon.discount_percent }}</text>
          <text class="discount" wx:if="{{ coupon.type == 2 }}">折</text>
          <text class="reduceCost" wx:if="{{coupon.type == 1}}">{{ coupon.discount_amount }}</text>
        </view>
        <view class="couponTitle">满{{ coupon.transaction_minimum }}元使用</view>
      </view>
      <view class="center">
        <view wx:if="{{ coupon.description && coupon.description.length }}" wx:key="index" wx:for="{{ coupon.description }}" wx:for-item="desc" class="couponDesc">
          • {{ desc }}
        </view>
        <text wx:if="{{ coupon.date_type === '2' && coupon.status === 2}}">
          领券当日起{{ coupon.expire_date }}日内可用
        </text>
        <text wx:else>
          有效期：{{ coupon.enable_start_date }}-{{  filter.getDateDay(coupon.enable_end_date) }}
          <!-- 有效期：{{ coupon.expire_date }}前可用 -->
        </text>
      </view>
      <view wx:if="{{!onlyShow}}" class="right {{ canChoice ? 'rightCenter' : '' }}">
        <view wx:if="{{!canChoice}}">
          <block wx:if="{{ !(status === 'available' || status === 'unavailable') }}">
            <!-- 已领取 -->
            <block wx:if="{{ status === 'received' }}">
              <button wx:if="{{ PLATFFORM_ENV === 'CUILV' }}" class="normalizeBt btn" open-type="share" data-id="{{ coupon.user_coupon_id }}" catch:tap="onGiveCoupon">
                <view class="useBtn">立即赠送</view>
                <view class="arrow">
                  <image src="/icons/couponArrow.png" mode="aspectFit" />
                </view>
              </button>
              <view wx:else class="btn">
                <view class="useBtn">立即使用</view>
                <view class="arrow">
                  <image src="/icons/couponArrow.png" mode="aspectFit" />
                </view>
              </view>
            </block>
            <!-- 未领取 -->
            <view class="btn" wx:if="{{status === 'receivable' }}">
              <view class="useBtn">立即领取</view>
              <view class="arrow">
                <image src="/icons/couponArrow.png" mode="aspectFit" />
              </view>
            </view>
            <view class="btn" wx:if="{{ status === 'used' }}">已使用</view>
            <view class="btn" wx:if="{{ status === 'expired' }}">已过期</view>
            <view class="btn" wx:if="{{ status === 'nullCoupon' }}">已抢光</view>
          </block>
        </view>
        <view class="radio {{ isSelected ? 'selected' : '' }}" wx:if="{{ canChoice }}">
          <image src="/icons/selected.png" mode="aspectFit" class="radioIcon" wx:if="{{ isSelected }}" />
        </view>
      </view>
    </view>
    <image class="bg" src="{{ config.cdn_host + '/shop/coupon/' + color + '/longCoupon.png'}}" wx:if="{{ color && status === 'receivable' }}" />
    <image class="bg" src="{{ config.cdn_host + '/shop/coupon/' + color + '/longCouponReceived.png'}}" wx:if="{{ color && (status === 'available' || status === 'received') }}" />
    <image class="bg" src="{{ config.cdn_host + '/shop/coupon/' + color + '/longCouponOut.png'}}" wx:if="{{ color && (status === 'used' || status === 'expired' || status === 'nullCoupon' || status === 'unavailable')}}" />
  </view>
</view>
<wxs module="filter" src="utils/wxs/timeTranslate.wxs" />